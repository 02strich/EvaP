{% extends "results_base.html" %}

{% load i18n %}
{% load morefilters %}

{% block subtitle %}{{ block.super }} - {{ semester.name }}{% endblock %}

{{% block content %}
    {{ block.super }}
    <h3>
        {{ semester.name }}
    </h3>

    {% if request.user.is_staff %}
    <p>
        <a href="{% url evap.results.views.semester_export semester.id %}">{% trans "Export semester as Excel table" %}</a>&nbsp;&middot;
        <a href="{% url evap.results.views.semester_export semester.id %}?all">{% trans "Export semester as Excel table (GF)" %}</a>
    </p>
    {% endif %}
    
    {% regroup courses by study as studies %}
    <table>
    {% for study in studies %}
        <tr>
            <td colspan="2">
                <h4>{{ study.grouper }}</h4>
            </td>
        </tr>
        {% for course in study.list %}
            <tr class="{% cycle "odd" "even" %}">
                <td><a href="{% url evap.results.views.course_detail semester.id course.id %}">{{ course }}</a></td>
                <td>{{ course.grade|floatformat:1 }}</td>
                
                {% if course.participants.count %}
                    <td class="dontbreak right">{{ course.voters.count }}/{{ course.participants.count }}</td>
                    <td class="dontbreak">({{ course.voters.count|percentage:course.participants.count }})</td>
                {% else %}
                    <td class="center" colspan="2">&mdash;</td>
                {% endif %}
            </tr>
        {% endfor %}
    {% endfor %}
    </table>
{% endblock %}
