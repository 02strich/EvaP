{% extends "fsr_base.html" %}

{% load i18n %}
{% load static %}

{% block content %}
    {{ block.super }}
    <p>
        <form method="POST" class="multiselect-form">
            {% csrf_token %}
            <fieldset>
                <legend>{% trans "General Options" %}</legend>
                {{ form.as_div }}
            </fieldset>
            
            <fieldset>
                <legend>{% trans "Lecturers" %}</legend>
                {{ formset.management_form }}
            </fieldset>
            
            {{ formset.non_form_errors }}
            
            <table id="assignment_table">
                <tr>
                    {% for field in formset.form %}
                        <th>{{ field.label }}x</th>
                    {% endfor %}
                    <th>{% trans "Delete?" %}</th>
                </tr>
                <tbody>
                    {% for form_element in formset %}
                        {% if form_element.non_field_errors %}
                            <tr><td colspan=100>{{ form_element.non_field_errors }}</td></tr>
                        {% endif %}
                        <tr>
                            <tr><td>
                                {{ form_element.id }}
                                {{ form_element.lecturer }} {% trans "Delete?" %}
                                {{ form_element.DELETE }}
                            </td></tr>
                            <tr><td>{{ form_element.questionnaires }}</td></tr>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            <div class="actions">
                <input type="submit" value="{% trans "Save course" %}" class="btn primary"/>
            </div>
        </form>
    </p>
{% endblock %}

{% block scripts %}
    {{ block.super }}
	
	<script>
		$(document).ready(function() {
			$.localise('ui-multiselect', {/*language: 'en',*/ path: '{% get_static_prefix %}js/locale/'});
			$(".multiselect-form select[multiple='multiple']").each(function(i,e) {
				$(e).width($(e).width());
				$(e).multiselect();
			});
			
			//TODO: re-add
			//$('#assignment_table tbody tr').formset({prefix: 'assignment_set'});
			
			$('#id_study').combobox();
			$('#id_kind').combobox();
		});
    </script>
	
	<!-- prevent from accendential closing -->
	<script type="text/javascript" src="{% get_static_prefix %}js/leave.js"></script>
{% endblock %}
