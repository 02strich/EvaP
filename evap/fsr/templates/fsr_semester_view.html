{% extends "fsr_base.html" %}

{% load i18n %}
{% load static %}
{% load morefilters %}

{% block content %}
    {{ block.super }}
    {% if courses_by_state %}
            {% for state, courses in courses_by_state %}
                <h3>{% trans "State" %}: {% trans state %} ({{ courses|length }})</h3>
                <table class="full-width">
                {% for course in courses %}
                    <tr class="{% if forloop.counter|divisibleby:2 %}even{% else %}odd{% endif %}">
                        <td>
                            {% with course.warnings as warnings %}
                                {% if warnings %}
                                    <img src="{% get_static_prefix %}images/silk/exclamation.png" title="{{ warnings|join:" " }}">
                                {% endif %}
                            {% endwith %}
                        </td>
                        <td><em>{% ifchanged %}{{ course.study }}{% endifchanged %}</em></td>
                        <td class="expand">
                            {% if course.can_fsr_edit %}
                                <a href="{% url evap.fsr.views.course_edit semester.id, course.id %}">{{ course.name }}</a>
                            {% else %}
                                {{ course.name }}
                            {% endif %}
                        </td>
                        <td class="dontbreak">{{ course.vote_start_date|date:"SHORT_DATE_FORMAT" }} - {{ course.vote_end_date|date:"SHORT_DATE_FORMAT" }}</td>
                        {% if state == 'inEvaluation' or state == 'pendingForReview' or state == 'pendingPublishing' or state == 'published' %}
                            {% if course.num_participants %}
                                <td class="dontbreak right">{{ course.num_voters }}/{{ course.num_participants }}</td>
                                <td class="dontbreak">({{ course.num_voters|percentage:course.num_participants }})</td>
                            {% else %}
                                <td class="center" colspan="2">&mdash;</td>
                            {% endif %}
                        {% endif %}
                        <td class="dontbreak">
                            <a href="{% url evap.fsr.views.course_email semester.id, course.id %}" title="{% trans "Write E-Mail" %}"><img src="{% get_static_prefix %}images/silk/email.png"> E-Mail</a>&nbsp;
                            {% if course.can_fsr_delete %}
                                <a href="{% url evap.fsr.views.course_delete semester.id, course.id %}" title="{% trans "Delete" %}"><img src="{% get_static_prefix %}images/silk/bin.png"></a>&nbsp;
                            {% endif %}
                            {% if course.can_fsr_review %}
                                <a href="{% url evap.fsr.views.course_censor semester.id, course.id %}" title="{% trans "Censor" %}"><img src="{% get_static_prefix %}images/silk/eye.png"></a>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </table>
                
                <p>
                {% ifequal state "new" %}
                    <a class="abutton" href="{% url evap.fsr.views.semester_lecturer_ready semester.id %}">{% trans "Enable Courses for Lecturer Review" %}</a>
                {% endifequal %}
                {% if state == 'new' or state == 'pendingLecturerApproval' or state == 'pendingFsrApproval' %}
                    <a class="abutton" href="{% url evap.fsr.views.semester_approve semester.id %}">{% trans "Approve Courses" %}</a>
                {% endif %}
                {% ifequal state "pendingPublishing" %}
                    <a class="abutton" href="{% url evap.fsr.views.semester_publish semester.id %}">{% trans "Publish Courses" %}</a>
                {% endifequal %}
                </p>
                <p>&nbsp;</p>
            {% endfor %}
    {% else %}
        <p>{% trans "There are no courses for this semester yet." %}</p>
    {% endif %}
{% endblock %}
